map "http://hl7.at/fhir/HL7ATCoreProfiles/4.0.1/StructureMap/at-cda-to-fhir-types" = "CdaToFhirTypes"


// Adapted from https://github.com/HL7/ccda-to-fhir/tree/master/mappings
// CDA:  http://build.fhir.org/ig/ahdis/cda-core-2.0/branches/master/index.html
// FHIR: http://hl7.org/fhir/r4/


// TODO review mapping
// based on BlackTusk
conceptmap "ELGA2FHIRAddressUse" {
  prefix s = "http://terminology.hl7.org/CodeSystem/v3-AddressUse"
  prefix t = "http://hl7.org/fhir/address-use"

  s:"H" == t:"home" // home address -> use = home; type = both
  s:"HP" == t: "home" // primary home -> use = home; type = both
  s:"HV" == t: "home" // vacation home -> use = home; type = both

  s:"WP" == t:"work" // work place -> use = work; type = both
  s:"DIR" == t:"work" // direct -> use = work; type = both
  s:"PUB" == t:"work" // public -> use = work; type = both

  s:"TMP" == t:"temp" // temporary address -> use = temp; type = both

  s:"PHYS" == t:"home" // physical visit address -> use = home; type = physical
  s:"PST" == t:"home" // billing address -> use = home; type = postal
}

// TODO review mapping
// based on BlackTusk
conceptmap "ELGATelecomAddressUseFHIRContactPointUse" {
  prefix s = "http://terminology.hl7.org/CodeSystem/v3-AddressUse"
  prefix t = "http://hl7.org/fhir/contact-point-use"

  s:"H" == t:"home"  // telephone home -> home
  s:"HP" == t:"home" // telephone primary home -> home
  s:"HV" == t:"home" // telephone vacation home -> home

  s:"WP" == t:"work" // telephone work -> work
  s:"AS" == t:"work" // answering service -> work

  s:"EC" == t:"home" // emergency contact -> home, FHIR home "typically used with urgent cases"

  s:"MC" == t:"mobile" // mobile contact -> mobile
  s:"PG" == t:"mobile" // pager -> mobile

  s:"TMP" == t:"temp" // temporary contact
}

// TODO review mapping
// based on BlackTusk
conceptmap "ELGAEntityNameUseFHIRNameUse" {
  prefix s = "http://terminology.hl7.org/CodeSystem/v3-EntityNameUse"
  prefix t = "http://hl7.org/fhir/name-use"

  s:"ASGN" == t:"usual" // assigned -> usual
  s:"C" == t:"usual" // License -> usual
  s:"I" == t:"anonymous" // Indigenious/Tribal -> anonymous
  s:"L" == t:"official" // Legal -> official
  s:"OR" == t:"official" // official registry -> official
  s:"P" == t:"anonymous" // pseudonym -> anonymous
  s:"A" == t:"anonymous" // Artist/Stage -> anonymous
  s:"R" == t:"anonymous" // Religious -> anonymous
  s:"SRCH" == t:"temp" // search v:HL7SearchUse -> temp
  s:"PHON" == t:"nickname" // phonetic -> nickname
  s:"SNDX" == t:"nickname" // soundex ->  nickname
  s:"ABC" == t:"nickname" // alphabetic -> nickname
  s:"IDE" == t:"nickname" // ideographic -> nickname
  s:"SYL" == t:"nickname" // syllabic -> nickname
}

// TODO review mapping
// TODO add TITLE to name-part-qualifier
// As soon as 'TITLE' is part of FHIR name-part-qualifier this conceptmap is obsolete.
conceptmap "ELGAEntityNamePartQualifierFHIRNamePartQualifier" {
  prefix s = "http://terminology.hl7.org/CodeSystem/v3-EntityNamePartQualifier"
  prefix t = "http://terminology.hl7.org/CodeSystem/v3-EntityNamePartQualifierR2"

  s:"AC" == t:"AC"
  s:"AD" == t:"AD"
  s:"BR" == t:"BR"
  s:"CL" == t:"CL"
  s:"IN" == t:"IN"
  s:"LS" == t:"LS"
  s:"NB" == t:"NB"
  s:"PR" == t:"PR"
  s:"SP" == t:"SP"
  // s:"TITLE" == t:"TITLE" currently not supported
  s:"VV" == t:"VV"
}

conceptmap "OIDtoURI" {
  prefix s = "http://cda.oid"
  prefix t = "http://fhir.system"

  // TODO see how Matchbox AND MaLaC can be supported
  // unmapped for s = provided
  // entries based on https://github.com/hapifhir/org.hl7.fhir.core/blob/b590cb3fedbb0791702c637e76fefdae2cba2f78/org.hl7.fhir.utilities/src/main/java/org/hl7/fhir/utilities/OIDUtils.java#L43
  // lines have been commented out where they're not supposed to be relevant for AT
  s:"2.16.840.1.113883.6.96" == t:"http://snomed.info/sct"
  s:"2.16.840.1.113883.6.1" == t:"http://loinc.org"
  s:"2.16.840.1.113883.6.8" == t:"http://unitsofmeasure.org"
  s:"2.16.840.1.113883.6.3" == t:"http://hl7.org/fhir/sid/icd-10"
  // s:"2.16.840.1.113883.6.42" == t:"http://hl7.org/fhir/sid/icd-9"
  // s:"2.16.840.1.113883.6.104" == t:"http://hl7.org/fhir/sid/icd-9"
  // s:"2.16.840.1.113883.6.103" == t:"http://hl7.org/fhir/sid/icd-9" // TODO confirm this
  s:"2.16.840.1.113883.6.73" == t:"http://www.whocc.no/atc"
  // s:"2.16.840.1.113883.3.26.1.1" == t:"http://ncimeta.nci.nih.gov"
  // s:"2.16.840.1.113883.3.26.1.1.1" == t:"http://ncimeta.nci.nih.gov"
  // s:"2.16.840.1.113883.6.88" == t:"http://www.nlm.nih.gov/research/umls/rxnorm" // TODO confirm this
  // s:"2.16.840.1.113883.6.59" == t:"http://hl7.org/fhir/sid/cvx"
  // s:"2.16.840.1.113883.12.292" == t:"http://hl7.org/fhir/sid/cvx"
  // s:"2.16.840.1.113883.6.12" == t:"http://www.ama-assn.org/go/cpt"

  // additional mappings relevant for AT (based on termgit.elga.gv.at)
  s:"2.16.840.1.113883.2.16.1.4.9" == t:"urn:oid:2.16.840.1.113883.2.16.1.4.9"
  s:"2.16.840.1.113883.5.83" == t:"http://terminology.hl7.org/CodeSystem/v3-ObservationInterpretation"
  s:"0.4.0.127.0.16.1.1.2.1" == t:"https://termgit.elga.gv.at/CodeSystem/ehdsi-edqm-auszug"
  s:"1.0.3166.1.2.2" == t:"https://termgit.elga.gv.at/CodeSystem/iso-3166-alpha-2-code"
  s:"1.0.3166.1.2.3" == t:"https://termgit.elga.gv.at/CodeSystem/iso-3166-1-alpha-3"
  s:"1.0.5218" == t:"https://termgit.elga.gv.at/CodeSystem/geschlechtercodes-iso-iec-5218"
  s:"1.0.639.2" == t:"https://termgit.elga.gv.at/CodeSystem/iso-639-2"
  s:"1.2.276.0.76.5.547" == t:"https://termgit.elga.gv.at/CodeSystem/atc-deutsch-wido"
  s:"1.2.40.0.10.1.4.3.4.3.2" == t:"https://termgit.elga.gv.at/CodeSystem/elga-medikationmengenartalternativ"
  s:"1.2.40.0.10.1.4.3.4.3.3" == t:"https://termgit.elga.gv.at/CodeSystem/medikationrezeptart"
  s:"1.2.40.0.10.1.4.3.4.3.4" == t:"https://termgit.elga.gv.at/CodeSystem/medikationartanwendung"
  s:"1.2.40.0.10.1.4.3.4.3.5" == t:"https://termgit.elga.gv.at/CodeSystem/medikationdarreichungsform"
  s:"1.2.40.0.10.1.4.3.4.3.6" == t:"https://termgit.elga.gv.at/CodeSystem/medikationtherapieart"
  s:"1.2.40.0.10.1.4.3.4.3.7" == t:"https://termgit.elga.gv.at/CodeSystem/medikationrezeptpflichtstatus"
  s:"1.2.40.0.34.10.10" == t:"https://termgit.elga.gv.at/ValueSet/elga-languagecode"
  s:"1.2.40.0.34.10.11" == t:"https://termgit.elga.gv.at/ValueSet/elga-maritalstatus"
  s:"1.2.40.0.34.10.13" == t:"https://termgit.elga.gv.at/ValueSet/elga-observationinterpretation"
  s:"1.2.40.0.34.10.14" == t:"https://termgit.elga.gv.at/ValueSet/langid-at"
  s:"1.2.40.0.34.10.15" == t:"https://termgit.elga.gv.at/ValueSet/elga-participationfunctioncode"
  s:"1.2.40.0.34.10.150" == t:"https://termgit.elga.gv.at/ValueSet/elga-auditeventid"
  s:"1.2.40.0.34.10.151" == t:"https://termgit.elga.gv.at/ValueSet/elga-auditeventtype"
  s:"1.2.40.0.34.10.152" == t:"https://termgit.elga.gv.at/ValueSet/elga-auditsourcetype"
  s:"1.2.40.0.34.10.153" == t:"https://termgit.elga.gv.at/ValueSet/elga-auditroleid"
  s:"1.2.40.0.34.10.154" == t:"https://termgit.elga.gv.at/ValueSet/elga-auditparticipantobjecttype"
  s:"1.2.40.0.34.10.155" == t:"https://termgit.elga.gv.at/ValueSet/elga-auditparticipantobjecttyperole"
  s:"1.2.40.0.34.10.156" == t:"https://termgit.elga.gv.at/ValueSet/elga-auditparticipantobjectidtype"
  s:"1.2.40.0.34.10.158" == t:"https://termgit.elga.gv.at/ValueSet/dicom-sopclasses"
  s:"1.2.40.0.34.10.159" == t:"https://termgit.elga.gv.at/ValueSet/elga-medikationabgabeart"
  s:"1.2.40.0.34.10.16" == t:"https://termgit.elga.gv.at/ValueSet/elga-addressuse"
  s:"1.2.40.0.34.10.160" == t:"https://termgit.elga.gv.at/ValueSet/elga-actcode-abginfo"
  s:"1.2.40.0.34.10.161" == t:"https://termgit.elga.gv.at/ValueSet/elga-actcode-patinfo"
  s:"1.2.40.0.34.10.162" == t:"https://termgit.elga.gv.at/ValueSet/elga-wirkstoffe-ages"
  s:"1.2.40.0.34.10.164" == t:"https://termgit.elga.gv.at/ValueSet/elga-sectionspflegesitber"
  s:"1.2.40.0.34.10.165" == t:"https://termgit.elga.gv.at/ValueSet/elga-auditeventtype-a-arr"
  s:"1.2.40.0.34.10.166" == t:"https://termgit.elga.gv.at/ValueSet/elga-dosisparameter"
  s:"1.2.40.0.34.10.167" == t:"https://termgit.elga.gv.at/ValueSet/elga-problemstatuscode"
  s:"1.2.40.0.34.10.168" == t:"https://termgit.elga.gv.at/ValueSet/elga-diagnosesicherheit"
  s:"1.2.40.0.34.10.169" == t:"https://termgit.elga.gv.at/ValueSet/elga-problemkataloge"
  s:"1.2.40.0.34.10.17" == t:"https://termgit.elga.gv.at/ValueSet/elga-personalrelationship"
  s:"1.2.40.0.34.10.171" == t:"https://termgit.elga.gv.at/ValueSet/elga-kulturerregernachweis"
  s:"1.2.40.0.34.10.172" == t:"https://termgit.elga.gv.at/ValueSet/elga-laendercodes"
  s:"1.2.40.0.34.10.173" == t:"https://termgit.elga.gv.at/ValueSet/elga-humanlanguage"
  s:"1.2.40.0.34.10.174" == t:"https://termgit.elga.gv.at/ValueSet/elga-proficiencylevelcode"
  s:"1.2.40.0.34.10.175" == t:"https://termgit.elga.gv.at/ValueSet/elga-languageabilitymode"
  s:"1.2.40.0.34.10.176" == t:"https://termgit.elga.gv.at/ValueSet/elga-seitenlokalisation"
  s:"1.2.40.0.34.10.177" == t:"https://termgit.elga.gv.at/ValueSet/elga-allergyorintolerancetype"
  s:"1.2.40.0.34.10.178" == t:"https://termgit.elga.gv.at/ValueSet/elga-absentorunknownallergies"
  s:"1.2.40.0.34.10.179" == t:"https://termgit.elga.gv.at/ValueSet/elga-absentorunknownproblems"
  s:"1.2.40.0.34.10.18" == t:"https://termgit.elga.gv.at/ValueSet/elga-religiousaffiliation"
  s:"1.2.40.0.34.10.180" == t:"https://termgit.elga.gv.at/ValueSet/elga-allergyorintoleranceagent"
  s:"1.2.40.0.34.10.181" == t:"https://termgit.elga.gv.at/ValueSet/elga-allergyreaction"
  s:"1.2.40.0.34.10.182" == t:"https://termgit.elga.gv.at/ValueSet/elga-criticalityobservationvalue"
  s:"1.2.40.0.34.10.183" == t:"https://termgit.elga.gv.at/ValueSet/elga-allergystatuscode"
  s:"1.2.40.0.34.10.184" == t:"https://termgit.elga.gv.at/ValueSet/elga-conditionverificationstatus"
  s:"1.2.40.0.34.10.186" == t:"https://termgit.elga.gv.at/ValueSet/elga-nachweisergebnis"
  s:"1.2.40.0.34.10.187" == t:"https://termgit.elga.gv.at/ValueSet/elga-probenmaterial"
  s:"1.2.40.0.34.10.188" == t:"https://termgit.elga.gv.at/ValueSet/elga-mikroorganismen"
  s:"1.2.40.0.34.10.189" == t:"https://termgit.elga.gv.at/ValueSet/elga-problemseverity"
  s:"1.2.40.0.34.10.19" == t:"https://termgit.elga.gv.at/ValueSet/elga-roleclass"
  s:"1.2.40.0.34.10.191" == t:"https://termgit.elga.gv.at/ValueSet/elga-absentorunknownmedication"
  s:"1.2.40.0.34.10.192" == t:"https://termgit.elga.gv.at/ValueSet/elga-absentorunknowndevices"
  s:"1.2.40.0.34.10.193" == t:"https://termgit.elga.gv.at/ValueSet/elga-absentorunknownprocedures"
  s:"1.2.40.0.34.10.198" == t:"https://termgit.elga.gv.at/ValueSet/elga-conditionstatuscode"
  s:"1.2.40.0.34.10.2" == t:"https://termgit.elga.gv.at/ValueSet/elga-nullflavor"
  s:"1.2.40.0.34.10.202" == t:"https://termgit.elga.gv.at/ValueSet/elga-expecteddeliverydatemethod"
  s:"1.2.40.0.34.10.203" == t:"https://termgit.elga.gv.at/ValueSet/elga-pregnanciessummary"
  s:"1.2.40.0.34.10.204" == t:"https://termgit.elga.gv.at/ValueSet/elga-currentsmokingstatus"
  s:"1.2.40.0.34.10.205" == t:"https://termgit.elga.gv.at/ValueSet/elga-typeofproblem"
  s:"1.2.40.0.34.10.206" == t:"https://termgit.elga.gv.at/ValueSet/elga-allergietyp"
  s:"1.2.40.0.34.10.210" == t:"https://termgit.elga.gv.at/ValueSet/atcdabbr-noinformationqualifier"
  s:"1.2.40.0.34.10.211" == t:"https://termgit.elga.gv.at/ValueSet/atcdabbr-lateralityqualifiercode"
  s:"1.2.40.0.34.10.22" == t:"https://termgit.elga.gv.at/ValueSet/elga-serviceeventslabor"
  s:"1.2.40.0.34.10.25" == t:"https://termgit.elga.gv.at/ValueSet/elga-urlscheme"
  s:"1.2.40.0.34.10.26" == t:"https://termgit.elga.gv.at/ValueSet/elga-rollen"
  s:"1.2.40.0.34.10.27" == t:"https://termgit.elga.gv.at/ValueSet/elga-entitynameuse"
  s:"1.2.40.0.34.10.29" == t:"https://termgit.elga.gv.at/ValueSet/elga-informationrecipienttype"
  s:"1.2.40.0.34.10.3" == t:"https://termgit.elga.gv.at/ValueSet/elga-realmcode"
  s:"1.2.40.0.34.10.30" == t:"https://termgit.elga.gv.at/ValueSet/elga-medikationtherapieart"
  s:"1.2.40.0.34.10.32" == t:"https://termgit.elga.gv.at/ValueSet/elga-medikationmengenart"
  s:"1.2.40.0.34.10.33" == t:"https://termgit.elga.gv.at/ValueSet/elga-noinformation"
  s:"1.2.40.0.34.10.34" == t:"https://termgit.elga.gv.at/ValueSet/elga-vitalparameterarten"
  s:"1.2.40.0.34.10.35" == t:"https://termgit.elga.gv.at/ValueSet/elga-problemarten"
  s:"1.2.40.0.34.10.36" == t:"https://termgit.elga.gv.at/ValueSet/elga-telecomaddressuse"
  s:"1.2.40.0.34.10.360" == t:"https://termgit.elga.gv.at/ValueSet/elga-sectionsserviceevents"
  s:"1.2.40.0.34.10.39" == t:"https://termgit.elga.gv.at/ValueSet/elga-dokumentenklassen"
  s:"1.2.40.0.34.10.4" == t:"https://termgit.elga.gv.at/ValueSet/elga-administrativegender"
  s:"1.2.40.0.34.10.42" == t:"https://termgit.elga.gv.at/ValueSet/elga-medientyp"
  s:"1.2.40.0.34.10.43" == t:"https://termgit.elga.gv.at/ValueSet/elga-serviceeventperformer"
  s:"1.2.40.0.34.10.44" == t:"https://termgit.elga.gv.at/ValueSet/elga-laborparameter"
  s:"1.2.40.0.34.10.46" == t:"https://termgit.elga.gv.at/ValueSet/elga-specimentype"
  s:"1.2.40.0.34.10.47" == t:"https://termgit.elga.gv.at/ValueSet/elga-laborstruktur"
  s:"1.2.40.0.34.10.48" == t:"https://termgit.elga.gv.at/ValueSet/elga-sectionsentlassungaerztl"
  s:"1.2.40.0.34.10.49" == t:"https://termgit.elga.gv.at/ValueSet/elga-sectionsentlassungpflege"
  s:"1.2.40.0.34.10.5" == t:"https://termgit.elga.gv.at/ValueSet/elga-actencountercode"
  s:"1.2.40.0.34.10.50" == t:"https://termgit.elga.gv.at/ValueSet/elga-sectionsradiologie"
  s:"1.2.40.0.34.10.52" == t:"https://termgit.elga.gv.at/ValueSet/elga-humanactsite"
  s:"1.2.40.0.34.10.53" == t:"https://termgit.elga.gv.at/ValueSet/elga-entlassungsmanagementa"
  s:"1.2.40.0.34.10.55" == t:"https://termgit.elga.gv.at/ValueSet/elga-mammogramassessment"
  s:"1.2.40.0.34.10.57" == t:"https://termgit.elga.gv.at/ValueSet/elga-serviceeventsentlassbr"
  s:"1.2.40.0.34.10.58" == t:"https://termgit.elga.gv.at/ValueSet/elga-significantpathogens"
  s:"1.2.40.0.34.10.59" == t:"https://termgit.elga.gv.at/ValueSet/elga-einnahmezeitpunkte"
  s:"1.2.40.0.34.10.6" == t:"https://termgit.elga.gv.at/ValueSet/elga-authorspeciality"
  s:"1.2.40.0.34.10.60" == t:"https://termgit.elga.gv.at/ValueSet/elga-formatcodezusatz"
  s:"1.2.40.0.34.10.61" == t:"https://termgit.elga.gv.at/ValueSet/elga-formatcode"
  s:"1.2.40.0.34.10.62" == t:"https://termgit.elga.gv.at/ValueSet/appc-modalitaet"
  s:"1.2.40.0.34.10.63" == t:"https://termgit.elga.gv.at/ValueSet/appc-lateralitaet"
  s:"1.2.40.0.34.10.64" == t:"https://termgit.elga.gv.at/ValueSet/appc-prozeduren"
  s:"1.2.40.0.34.10.65" == t:"https://termgit.elga.gv.at/ValueSet/appc-anatomie"
  s:"1.2.40.0.34.10.66" == t:"https://termgit.elga.gv.at/ValueSet/elga-medikationartanwendung"
  s:"1.2.40.0.34.10.67" == t:"https://termgit.elga.gv.at/ValueSet/elga-medikationmengenartalternativ"
  s:"1.2.40.0.34.10.68" == t:"https://termgit.elga.gv.at/ValueSet/elga-medikationrezeptart"
  s:"1.2.40.0.34.10.69" == t:"https://termgit.elga.gv.at/ValueSet/elga-medikationfrequenz"
  s:"1.2.40.0.34.10.7" == t:"https://termgit.elga.gv.at/ValueSet/elga-confidentiality"
  s:"1.2.40.0.34.10.70" == t:"https://termgit.elga.gv.at/ValueSet/elga-medikationdarreichungsform"
  s:"1.2.40.0.34.10.71" == t:"https://termgit.elga.gv.at/ValueSet/elga-medikationpharmazeutischeempfehlungstatus"
  s:"1.2.40.0.34.10.72" == t:"https://termgit.elga.gv.at/ValueSet/elga-healthcarefacilitytypecode"
  s:"1.2.40.0.34.10.74" == t:"https://termgit.elga.gv.at/ValueSet/elga-medikationrezeptpflichtstatus"
  s:"1.2.40.0.34.10.75" == t:"https://termgit.elga.gv.at/ValueSet/elga-practicesetting"
  s:"1.2.40.0.34.10.86" == t:"https://termgit.elga.gv.at/ValueSet/hl7-at-xds-dokumentenklassen"
  s:"1.2.40.0.34.10.9" == t:"https://termgit.elga.gv.at/ValueSet/elga-insuredassocentity"
  s:"1.2.40.0.34.10.90" == t:"https://termgit.elga.gv.at/ValueSet/ems-anti-hcv-immunoassay"
  s:"1.2.40.0.34.10.91" == t:"https://termgit.elga.gv.at/ValueSet/ems-anti-hcv-immunoblot-assay"
  s:"1.2.40.0.34.10.92" == t:"https://termgit.elga.gv.at/ValueSet/ems-hcv-core-ag-assay"
  s:"1.2.40.0.34.10.93" == t:"https://termgit.elga.gv.at/ValueSet/ems-hbv-status"
  s:"1.2.40.0.34.3.1.10" == t:"https://termgit.elga.gv.at/CodeSystem/oeaek-berechtigungen"
  s:"1.2.40.0.34.3.1.10.20" == t:"https://termgit.elga.gv.at/CodeSystem/oeaek-fachrichtung"
  s:"1.2.40.0.34.3.1.10.30" == t:"https://termgit.elga.gv.at/CodeSystem/oeaek-additivfach"
  s:"1.2.40.0.34.3.1.10.40" == t:"https://termgit.elga.gv.at/CodeSystem/oeaek-spezialdiplom"
  s:"1.2.40.0.34.3.1.10.50" == t:"https://termgit.elga.gv.at/CodeSystem/oeaek-zertifikate"
  s:"1.2.40.0.34.3.1.10.60" == t:"https://termgit.elga.gv.at/CodeSystem/oeaek-spezialisierung"
  s:"1.2.40.0.34.4.16" == t:"https://termgit.elga.gv.at/CodeSystem/asp-liste"
  s:"1.2.40.0.34.4.16.1" == t:"https://termgit.elga.gv.at/CodeSystem/eimpf-impfstoffe"
  s:"1.2.40.0.34.5.101" == t:"https://termgit.elga.gv.at/CodeSystem/ems-parameter"
  s:"1.2.40.0.34.5.102" == t:"https://termgit.elga.gv.at/CodeSystem/ems-methoden"
  s:"1.2.40.0.34.5.103" == t:"https://termgit.elga.gv.at/CodeSystem/elga-actcode"
  s:"1.2.40.0.34.5.104" == t:"https://termgit.elga.gv.at/CodeSystem/rast-klassen"
  s:"1.2.40.0.34.5.105" == t:"https://termgit.elga.gv.at/CodeSystem/ems-krankheitsmerkmale"
  s:"1.2.40.0.34.5.106" == t:"https://termgit.elga.gv.at/CodeSystem/ems-hcv-rna"
  s:"1.2.40.0.34.5.109" == t:"https://termgit.elga.gv.at/CodeSystem/ems-klinischemanifestation"
  s:"1.2.40.0.34.5.11" == t:"https://termgit.elga.gv.at/CodeSystem/elga-laborparameterergaenzung"
  s:"1.2.40.0.34.5.110" == t:"https://termgit.elga.gv.at/CodeSystem/ems-wurdekrankheitimportiert"
  s:"1.2.40.0.34.5.12" == t:"https://termgit.elga.gv.at/CodeSystem/elga-practicesetting"
  s:"1.2.40.0.34.5.150" == t:"https://termgit.elga.gv.at/CodeSystem/elga-auditeventid"
  s:"1.2.40.0.34.5.151" == t:"https://termgit.elga.gv.at/CodeSystem/elga-auditeventtype"
  s:"1.2.40.0.34.5.152" == t:"https://termgit.elga.gv.at/CodeSystem/elga-auditsourcetype"
  s:"1.2.40.0.34.5.153" == t:"https://termgit.elga.gv.at/CodeSystem/elga-auditparticipantobjecttype"
  s:"1.2.40.0.34.5.154" == t:"https://termgit.elga.gv.at/CodeSystem/elga-auditparticipantobjecttyperole"
  s:"1.2.40.0.34.5.155" == t:"https://termgit.elga.gv.at/CodeSystem/elga-auditparticipantobjectidtype"
  s:"1.2.40.0.34.5.156" == t:"https://termgit.elga.gv.at/CodeSystem/medikation-ages-wirkstoffe"
  s:"1.2.40.0.34.5.158" == t:"https://termgit.elga.gv.at/CodeSystem/elga-funktionsrollen"
  s:"1.2.40.0.34.5.159" == t:"https://termgit.elga.gv.at/CodeSystem/elga-e-health-anwendungen"
  s:"1.2.40.0.34.5.160" == t:"https://termgit.elga.gv.at/CodeSystem/elga-fachaerzte"
  s:"1.2.40.0.34.5.161" == t:"https://termgit.elga.gv.at/CodeSystem/elga-kontakttypen"
  s:"1.2.40.0.34.5.162" == t:"https://termgit.elga.gv.at/CodeSystem/elga-patienten-identifizierungsmethoden"
  s:"1.2.40.0.34.5.165" == t:"https://termgit.elga.gv.at/CodeSystem/elga-auditeventtypea-arr"
  s:"1.2.40.0.34.5.171" == t:"https://termgit.elga.gv.at/CodeSystem/icd-10-bmg-2017"
  s:"1.2.40.0.34.5.173" == t:"https://termgit.elga.gv.at/CodeSystem/elga-specimentype-ergaenzung"
  s:"1.2.40.0.34.5.175" == t:"https://termgit.elga.gv.at/CodeSystem/icpc2"
  s:"1.2.40.0.34.5.179" == t:"https://termgit.elga.gv.at/CodeSystem/elga-ergaenzungsliste"
  s:"1.2.40.0.34.5.180" == t:"https://termgit.elga.gv.at/CodeSystem/elga-allergietyp"
  s:"1.2.40.0.34.5.183" == t:"https://termgit.elga.gv.at/CodeSystem/eimpf-ergaenzung"
  s:"1.2.40.0.34.5.184" == t:"https://termgit.elga.gv.at/CodeSystem/icd-10-bmg-2020"
  s:"1.2.40.0.34.5.186" == t:"https://termgit.elga.gv.at/CodeSystem/eimpf-historischeimpfstoffe"
  s:"1.2.40.0.34.5.187" == t:"https://termgit.elga.gv.at/CodeSystem/ems-ergaenzungmeldepflichtigekrankheiten"
  s:"1.2.40.0.34.5.190" == t:"https://termgit.elga.gv.at/CodeSystem/elga-pflegestufen"
  s:"1.2.40.0.34.5.191" == t:"https://termgit.elga.gv.at/CodeSystem/eimpf-zuordnungsmatrix"
  s:"1.2.40.0.34.5.194" == t:"https://termgit.elga.gv.at/CodeSystem/exnds-sections"
  s:"1.2.40.0.34.5.195" == t:"https://termgit.elga.gv.at/CodeSystem/exnds-concepts"
  s:"1.2.40.0.34.5.196" == t:"https://termgit.elga.gv.at/CodeSystem/ems-betreuung"
  s:"1.2.40.0.34.5.197" == t:"https://termgit.elga.gv.at/CodeSystem/ems-listeschulen"
  s:"1.2.40.0.34.5.198" == t:"https://termgit.elga.gv.at/CodeSystem/exnds-metadaten"
  s:"1.2.40.0.34.5.199" == t:"https://termgit.elga.gv.at/CodeSystem/exnds-formatcodes"
  s:"1.2.40.0.34.5.2" == t:"https://termgit.elga.gv.at/CodeSystem/elga-gtelvogdarollen"
  s:"1.2.40.0.34.5.200" == t:"https://termgit.elga.gv.at/CodeSystem/eimpf-schemamatrix"
  s:"1.2.40.0.34.5.202" == t:"https://termgit.elga.gv.at/CodeSystem/dgc-qr"
  s:"1.2.40.0.34.5.203" == t:"https://termgit.elga.gv.at/CodeSystem/dgc-antibody-test"
  s:"1.2.40.0.34.5.205" == t:"https://termgit.elga.gv.at/CodeSystem/dgc-ratnamemanufacturer"
  s:"1.2.40.0.34.5.206" == t:"https://termgit.elga.gv.at/CodeSystem/lkf-diagnose-typ"
  s:"1.2.40.0.34.5.207" == t:"https://termgit.elga.gv.at/CodeSystem/lkf-diagnose-art"
  s:"1.2.40.0.34.5.208" == t:"https://termgit.elga.gv.at/CodeSystem/lkf-diagnose-statauf"
  s:"1.2.40.0.34.5.209" == t:"https://termgit.elga.gv.at/CodeSystem/bmg-icd-10-2022"
  s:"1.2.40.0.34.5.21" == t:"https://termgit.elga.gv.at/CodeSystem/elga-serviceeventsentlassbrief"
  s:"1.2.40.0.34.5.211" == t:"https://termgit.elga.gv.at/CodeSystem/lkf-ergaenzung"
  s:"1.2.40.0.34.5.215" == t:"https://termgit.elga.gv.at/CodeSystem/elga-lebensmittelallergene"
  s:"1.2.40.0.34.5.216" == t:"https://termgit.elga.gv.at/CodeSystem/bmg-lkf-2023"
  s:"1.2.40.0.34.5.217" == t:"https://termgit.elga.gv.at/CodeSystem/austrian-designation-use"
  s:"1.2.40.0.34.5.219" == t:"https://termgit.elga.gv.at/CodeSystem/medikationpackaging"
  s:"1.2.40.0.34.5.221" == t:"https://termgit.elga.gv.at/CodeSystem/medikationactiveingredient"
  s:"1.2.40.0.34.5.222" == t:"https://termgit.elga.gv.at/CodeSystem/bmg-icd-10-2024"
  s:"1.2.40.0.34.5.223" == t:"https://termgit.elga.gv.at/CodeSystem/bmg-lkf-2024"
  s:"1.2.40.0.34.5.224" == t:"https://termgit.elga.gv.at/CodeSystem/hl7-at-administrativegender-ergaenzung"
  s:"1.2.40.0.34.5.28" == t:"https://termgit.elga.gv.at/CodeSystem/elga-entlassungsmanagementart"
  s:"1.2.40.0.34.5.3" == t:"https://termgit.elga.gv.at/CodeSystem/elga-gda-aggregatrollen"
  s:"1.2.40.0.34.5.37" == t:"https://termgit.elga.gv.at/CodeSystem/elga-formatcode"
  s:"1.2.40.0.34.5.38.1" == t:"https://termgit.elga.gv.at/CodeSystem/appc-modalitaet"
  s:"1.2.40.0.34.5.38.2" == t:"https://termgit.elga.gv.at/CodeSystem/appc-lateralitaet"
  s:"1.2.40.0.34.5.38.3" == t:"https://termgit.elga.gv.at/CodeSystem/appc-prozeduren"
  s:"1.2.40.0.34.5.38.4" == t:"https://termgit.elga.gv.at/CodeSystem/appc-anatomie"
  s:"1.2.40.0.34.5.4" == t:"https://termgit.elga.gv.at/CodeSystem/gda-attribute"
  s:"1.2.40.0.34.5.40" == t:"https://termgit.elga.gv.at/CodeSystem/elga-sections"
  s:"1.2.40.0.34.5.41" == t:"https://termgit.elga.gv.at/CodeSystem/elga-formatcodezusatz"
  s:"1.2.40.0.34.5.45" == t:"https://termgit.elga.gv.at/CodeSystem/elga-significantpathogens"
  s:"1.2.40.0.34.5.49" == t:"https://termgit.elga.gv.at/CodeSystem/elga-mammogramassessment"
  s:"1.2.40.0.34.5.5" == t:"https://termgit.elga.gv.at/CodeSystem/gda-org"
  s:"1.2.40.0.34.5.55" == t:"https://termgit.elga.gv.at/CodeSystem/elga-urlschemeergaenzung"
  s:"1.2.40.0.34.5.56" == t:"https://termgit.elga.gv.at/CodeSystem/icd-10-bmg-2014"
  s:"1.2.40.0.34.5.58" == t:"https://termgit.elga.gv.at/CodeSystem/ems-material"
  s:"1.2.40.0.34.5.59" == t:"https://termgit.elga.gv.at/CodeSystem/ems-janein"
  s:"1.2.40.0.34.5.60" == t:"https://termgit.elga.gv.at/CodeSystem/ems-analysedetails"
  s:"1.2.40.0.34.5.61" == t:"https://termgit.elga.gv.at/CodeSystem/ems-antigenh"
  s:"1.2.40.0.34.5.62" == t:"https://termgit.elga.gv.at/CodeSystem/ems-artmalaria"
  s:"1.2.40.0.34.5.63" == t:"https://termgit.elga.gv.at/CodeSystem/ems-artquartier"
  s:"1.2.40.0.34.5.64" == t:"https://termgit.elga.gv.at/CodeSystem/ems-befundart"
  s:"1.2.40.0.34.5.65" == t:"https://termgit.elga.gv.at/CodeSystem/ems-biotyp-biovar"
  s:"1.2.40.0.34.5.66" == t:"https://termgit.elga.gv.at/CodeSystem/ems-antigeno"
  s:"1.2.40.0.34.5.67" == t:"https://termgit.elga.gv.at/CodeSystem/ems-tbc-resistenzergaenzung"
  s:"1.2.40.0.34.5.68" == t:"https://termgit.elga.gv.at/CodeSystem/ems-quartiercode"
  s:"1.2.40.0.34.5.69" == t:"https://termgit.elga.gv.at/CodeSystem/ems-aviditaet"
  s:"1.2.40.0.34.5.70" == t:"https://termgit.elga.gv.at/CodeSystem/ems-genogruppe"
  s:"1.2.40.0.34.5.71" == t:"https://termgit.elga.gv.at/CodeSystem/ems-genotyp"
  s:"1.2.40.0.34.5.72" == t:"https://termgit.elga.gv.at/CodeSystem/ems-genotyppora-r1"
  s:"1.2.40.0.34.5.73" == t:"https://termgit.elga.gv.at/CodeSystem/ems-genotyppora-r2"
  s:"1.2.40.0.34.5.74" == t:"https://termgit.elga.gv.at/CodeSystem/ems-durchgefuehrt"
  s:"1.2.40.0.34.5.75" == t:"https://termgit.elga.gv.at/CodeSystem/ems-tbc-resultat"
  s:"1.2.40.0.34.5.76" == t:"https://termgit.elga.gv.at/CodeSystem/ems-ergebnis"
  s:"1.2.40.0.34.5.77" == t:"https://termgit.elga.gv.at/CodeSystem/ems-wowurdekrankheiterworben"
  s:"1.2.40.0.34.5.78" == t:"https://termgit.elga.gv.at/CodeSystem/ems-nachweisbar"
  s:"1.2.40.0.34.5.79" == t:"https://termgit.elga.gv.at/CodeSystem/ems-testmethodemic-ipd"
  s:"1.2.40.0.34.5.80" == t:"https://termgit.elga.gv.at/CodeSystem/ems-testmethodetypingipd"
  s:"1.2.40.0.34.5.81" == t:"https://termgit.elga.gv.at/CodeSystem/ems-nachweis"
  s:"1.2.40.0.34.5.82" == t:"https://termgit.elga.gv.at/CodeSystem/ems-multilocsequ"
  s:"1.2.40.0.34.5.83" == t:"https://termgit.elga.gv.at/CodeSystem/ems-monoclonalsub"
  s:"1.2.40.0.34.5.84" == t:"https://termgit.elga.gv.at/CodeSystem/ems-organ"
  s:"1.2.40.0.34.5.85" == t:"https://termgit.elga.gv.at/CodeSystem/ems-yersinapathogen"
  s:"1.2.40.0.34.5.86" == t:"https://termgit.elga.gv.at/CodeSystem/ems-phagentyp-vtec"
  s:"1.2.40.0.34.5.87" == t:"https://termgit.elga.gv.at/CodeSystem/ems-phagentyp"
  s:"1.2.40.0.34.5.88" == t:"https://termgit.elga.gv.at/CodeSystem/ems-posneg"
  s:"1.2.40.0.34.5.89" == t:"https://termgit.elga.gv.at/CodeSystem/ems-ribotype"
  s:"1.2.40.0.34.5.90" == t:"https://termgit.elga.gv.at/CodeSystem/ems-serogruppe"
  s:"1.2.40.0.34.5.91" == t:"https://termgit.elga.gv.at/CodeSystem/ems-serotyp-gene-feta"
  s:"1.2.40.0.34.5.92" == t:"https://termgit.elga.gv.at/CodeSystem/ems-serotyp"
  s:"1.2.40.0.34.5.93" == t:"https://termgit.elga.gv.at/CodeSystem/ems-gewinnung"
  s:"1.2.40.0.34.5.94" == t:"https://termgit.elga.gv.at/CodeSystem/ems-tbc-typ"
  s:"1.2.40.0.34.5.95" == t:"https://termgit.elga.gv.at/CodeSystem/ems-orth20probe"
  s:"1.2.40.0.34.5.96" == t:"https://termgit.elga.gv.at/CodeSystem/ems-reiseland"
  s:"1.2.40.0.34.5.97" == t:"https://termgit.elga.gv.at/CodeSystem/ems-verotoxin-2-subtyp"
  s:"1.2.40.0.34.5.98" == t:"https://termgit.elga.gv.at/CodeSystem/ems-verotoxin-1-subtyp"
  s:"1.2.40.0.34.5.99" == t:"https://termgit.elga.gv.at/CodeSystem/ems-materialmethode"
  s:"1.2.40.0.34.6.0.10.10" == t:"https://termgit.elga.gv.at/ValueSet/eimpf-historischeimpfstoffe"
  s:"1.2.40.0.34.6.0.10.11" == t:"https://termgit.elga.gv.at/ValueSet/eimpf-impfrollen"
  s:"1.2.40.0.34.6.0.10.13" == t:"https://termgit.elga.gv.at/ValueSet/eimpf-antikoerperbestimmung"
  s:"1.2.40.0.34.6.0.10.14" == t:"https://termgit.elga.gv.at/ValueSet/eimpf-impfstoffe"
  s:"1.2.40.0.34.6.0.10.15" == t:"https://termgit.elga.gv.at/ValueSet/eimpf-specialsituationindication"
  s:"1.2.40.0.34.6.0.10.16" == t:"https://termgit.elga.gv.at/ValueSet/ems-materialmethode"
  s:"1.2.40.0.34.6.0.10.18" == t:"https://termgit.elga.gv.at/ValueSet/ems-krankheitsmerkmale"
  s:"1.2.40.0.34.6.0.10.19" == t:"https://termgit.elga.gv.at/ValueSet/ems-meldepflichtige-krankheiten"
  s:"1.2.40.0.34.6.0.10.2" == t:"https://termgit.elga.gv.at/ValueSet/eimpf-impfrelevanteerkrankung"
  s:"1.2.40.0.34.6.0.10.21" == t:"https://termgit.elga.gv.at/ValueSet/ems-taetigkeitsbereich"
  s:"1.2.40.0.34.6.0.10.23" == t:"https://termgit.elga.gv.at/ValueSet/elga-artderdiagnose"
  s:"1.2.40.0.34.6.0.10.24" == t:"https://termgit.elga.gv.at/ValueSet/ems-impfstatus"
  s:"1.2.40.0.34.6.0.10.25" == t:"https://termgit.elga.gv.at/ValueSet/ems-klinischemanifestation"
  s:"1.2.40.0.34.6.0.10.26" == t:"https://termgit.elga.gv.at/ValueSet/elga-serviceeventstelemonepi"
  s:"1.2.40.0.34.6.0.10.27" == t:"https://termgit.elga.gv.at/ValueSet/hl7-at-actconsenttype"
  s:"1.2.40.0.34.6.0.10.29" == t:"https://termgit.elga.gv.at/ValueSet/ems-lebensmittelbedingteintoxikationen"
  s:"1.2.40.0.34.6.0.10.3" == t:"https://termgit.elga.gv.at/ValueSet/eimpf-specialcasevaccination"
  s:"1.2.40.0.34.6.0.10.30" == t:"https://termgit.elga.gv.at/ValueSet/elga-alcoholconsumption"
  s:"1.2.40.0.34.6.0.10.31" == t:"https://termgit.elga.gv.at/ValueSet/ems-betreuung"
  s:"1.2.40.0.34.6.0.10.4" == t:"https://termgit.elga.gv.at/ValueSet/eimpf-immunizationtarget"
  s:"1.2.40.0.34.6.0.10.49" == t:"https://termgit.elga.gv.at/ValueSet/ems-hospitalisierung"
  s:"1.2.40.0.34.6.0.10.5" == t:"https://termgit.elga.gv.at/ValueSet/eimpf-impfschema"
  s:"1.2.40.0.34.6.0.10.51" == t:"https://termgit.elga.gv.at/ValueSet/ems-reiseland"
  s:"1.2.40.0.34.6.0.10.52" == t:"https://termgit.elga.gv.at/ValueSet/elga-pregnancystatus"
  s:"1.2.40.0.34.6.0.10.53" == t:"https://termgit.elga.gv.at/ValueSet/elga-antibiogramm"
  s:"1.2.40.0.34.6.0.10.54" == t:"https://termgit.elga.gv.at/ValueSet/dgc-typeoftest"
  s:"1.2.40.0.34.6.0.10.55" == t:"https://termgit.elga.gv.at/ValueSet/dgc-diseaseoragent"
  s:"1.2.40.0.34.6.0.10.56" == t:"https://termgit.elga.gv.at/ValueSet/dgc-vaccine"
  s:"1.2.40.0.34.6.0.10.57" == t:"https://termgit.elga.gv.at/ValueSet/dgc-medicinalproduct"
  s:"1.2.40.0.34.6.0.10.58" == t:"https://termgit.elga.gv.at/ValueSet/dgc-vaccinemarketingauthorizationholder"
  s:"1.2.40.0.34.6.0.10.59" == t:"https://termgit.elga.gv.at/ValueSet/dgc-doses"
  s:"1.2.40.0.34.6.0.10.6" == t:"https://termgit.elga.gv.at/ValueSet/eimpf-impfdosis"
  s:"1.2.40.0.34.6.0.10.60" == t:"https://termgit.elga.gv.at/ValueSet/dgc-resultofthetest"
  s:"1.2.40.0.34.6.0.10.62" == t:"https://termgit.elga.gv.at/ValueSet/eimpf-zusatzklassifikation"
  s:"1.2.40.0.34.6.0.10.63" == t:"https://termgit.elga.gv.at/ValueSet/dgc-country"
  s:"1.2.40.0.34.6.0.10.65" == t:"https://termgit.elga.gv.at/ValueSet/dgc-ratnamemanufacturer"
  s:"1.2.40.0.34.6.0.10.66" == t:"https://termgit.elga.gv.at/ValueSet/elga-anamneselabormikrobiologie"
  s:"1.2.40.0.34.6.0.10.67" == t:"https://termgit.elga.gv.at/ValueSet/lkf-diagnose-art"
  s:"1.2.40.0.34.6.0.10.68" == t:"https://termgit.elga.gv.at/ValueSet/lkf-diagnose-statauf"
  s:"1.2.40.0.34.6.0.10.69" == t:"https://termgit.elga.gv.at/ValueSet/lkf-diagnose-typ"
  s:"1.2.40.0.34.6.0.10.7" == t:"https://termgit.elga.gv.at/ValueSet/eimpf-impfgrund"
  s:"1.2.40.0.34.6.0.10.74" == t:"https://termgit.elga.gv.at/ValueSet/eimpf-mengenart"
  s:"1.2.40.0.34.6.0.10.75" == t:"https://termgit.elga.gv.at/ValueSet/elga-lebensmittelallergene"
  s:"1.2.40.0.34.6.0.10.76" == t:"https://termgit.elga.gv.at/ValueSet/austrian-designation-use"
  s:"1.2.40.0.34.6.0.10.77" == t:"https://termgit.elga.gv.at/ValueSet/hl7-at-patientidentifier"
  s:"1.2.40.0.34.6.0.10.78" == t:"https://termgit.elga.gv.at/ValueSet/eimpf-zusatzklassifikation-impfprogramm"
  s:"1.2.40.0.34.6.0.10.79" == t:"https://termgit.elga.gv.at/ValueSet/eimpf-zusatzklassifikation-impfsetting"
  s:"1.2.40.0.34.6.0.10.8" == t:"https://termgit.elga.gv.at/ValueSet/elga-entitynamepartqualifier"
  s:"1.2.40.0.34.6.0.10.81" == t:"https://termgit.elga.gv.at/ValueSet/hl7-at-administrativegender-v2"
  s:"1.2.40.0.34.6.0.10.83" == t:"https://termgit.elga.gv.at/ValueSet/hl7-at-administrativegender-fhir-extension"
  s:"1.2.40.0.34.6.0.10.84" == t:"https://termgit.elga.gv.at/ValueSet/orphanet-rare-diseases"
  s:"1.2.40.0.34.6.0.10.85" == t:"https://termgit.elga.gv.at/ValueSet/snomed-rare-diseases"
  s:"1.2.40.0.34.6.0.10.86" == t:"https://termgit.elga.gv.at/ValueSet/hl7-at-organizationtype"
  s:"1.2.40.0.34.6.0.10.87" == t:"https://termgit.elga.gv.at/ValueSet/hl7-at-practitionerrole"
  s:"1.2.840.10003.5.109" == t:"https://termgit.elga.gv.at/CodeSystem/iana-mime-type"
  s:"1.2.840.10008.2.16.4" == t:"https://termgit.elga.gv.at/CodeSystem/dcm"
  s:"1.2.840.10008.2.6.1" == t:"https://termgit.elga.gv.at/CodeSystem/dicom-sopclasses"
  s:"1.3.6.1.4.1.12559.11.10.1.3.1.42.1" == t:"https://termgit.elga.gv.at/ValueSet/ehdsi-healthcare-professional-role"
  s:"1.3.6.1.4.1.12559.11.10.1.3.1.42.12" == t:"https://termgit.elga.gv.at/ValueSet/ehdsi-route-of-administration"
  s:"1.3.6.1.4.1.12559.11.10.1.3.1.42.16" == t:"https://termgit.elga.gv.at/ValueSet/ehdsi-unit"
  s:"1.3.6.1.4.1.12559.11.10.1.3.1.42.2" == t:"https://termgit.elga.gv.at/ValueSet/ehdsi-doseform"
  s:"1.3.6.1.4.1.12559.11.10.1.3.1.42.24" == t:"https://termgit.elga.gv.at/ValueSet/ehdsi-activeingredient"
  s:"1.3.6.1.4.1.12559.11.10.1.3.1.42.3" == t:"https://termgit.elga.gv.at/ValueSet/ehdsi-package"
  s:"1.3.6.1.4.1.12559.11.10.1.3.1.42.31" == t:"https://termgit.elga.gv.at/ValueSet/ehdsi-confidentiality"
  s:"1.3.6.1.4.1.12559.11.10.1.3.1.42.34" == t:"https://termgit.elga.gv.at/ValueSet/ehdsi-administrative-gender"
  s:"1.3.6.1.4.1.12559.11.10.1.3.1.42.4" == t:"https://termgit.elga.gv.at/ValueSet/ehdsi-country"
  s:"1.3.6.1.4.1.12559.11.10.1.3.1.42.40" == t:"https://termgit.elga.gv.at/ValueSet/ehdsi-telecom-address"
  s:"1.3.6.1.4.1.12559.11.10.1.3.1.42.41" == t:"https://termgit.elga.gv.at/ValueSet/ehdsi-timing-event"
  s:"1.3.6.1.4.1.12559.11.10.1.3.1.42.56" == t:"https://termgit.elga.gv.at/ValueSet/ehdsi-quantity-unit"
  s:"1.3.6.1.4.1.12559.11.10.1.3.1.42.6" == t:"https://termgit.elga.gv.at/ValueSet/ehdsi-language"
  s:"1.3.6.1.4.1.12559.11.10.1.3.1.42.61" == t:"https://termgit.elga.gv.at/ValueSet/ehdsi-substance"
  s:"1.3.6.1.4.1.19376.1.9.2.1" == t:"https://termgit.elga.gv.at/CodeSystem/ihe-pharmaceutical-advice-status-list"
  s:"1dd183a6-6d2b-4a9d-8f5d-be09d6bb5a6e" == t:"https://termgit.elga.gv.at/CodeSystem/ehdsi-language"
  s:"2.16.840.1.113883.1.11.19708" == t:"https://termgit.elga.gv.at/ValueSet/ehdsi-actsubstanceadministrationcode"
  s:"2.16.840.1.113883.12.1" == t:"https://termgit.elga.gv.at/CodeSystem/hl7-administrative-sex"
  s:"2.16.840.1.113883.12.496" == t:"https://termgit.elga.gv.at/CodeSystem/hl7-consent-type"
  s:"2.16.840.1.113883.12.497" == t:"https://termgit.elga.gv.at/CodeSystem/hl7-consent-mode"
  s:"2.16.840.1.113883.12.498" == t:"https://termgit.elga.gv.at/CodeSystem/hl7-consent-status"
  s:"2.16.840.1.113883.12.548" == t:"https://termgit.elga.gv.at/CodeSystem/hl7-signatorys-relationship-to-subject"
  s:"2.16.840.1.113883.18.108" == t:"http://terminology.hl7.org/CodeSystem/v2-0203"
  s:"2.16.840.1.113883.18.2" == t:"http://terminology.hl7.org/CodeSystem/v2-0001"
  s:"2.16.840.1.113883.18.320" == t:"http://terminology.hl7.org/CodeSystem/v2-0496"
  s:"2.16.840.1.113883.18.321" == t:"http://terminology.hl7.org/CodeSystem/v2-0497"
  s:"2.16.840.1.113883.18.322" == t:"http://terminology.hl7.org/CodeSystem/v2-0498"
  s:"2.16.840.1.113883.18.355" == t:"http://terminology.hl7.org/CodeSystem/v2-0548"
  s:"2.16.840.1.113883.2.16.1.4.1" == t:"https://termgit.elga.gv.at/CodeSystem/hl7-at-religionaustria"
  s:"2.16.840.1.113883.2.16.1.4.10" == t:"https://termgit.elga.gv.at/CodeSystem/hl7-at-formatcodes"
  s:"2.16.840.1.113883.2.9.6.2.7" == t:"https://termgit.elga.gv.at/CodeSystem/isco"
  s:"2.16.840.1.113883.3.6905.2" == t:"https://termgit.elga.gv.at/CodeSystem/ehdsi-substance"
  s:"2.16.840.1.113883.3.7.1.7" == t:"https://termgit.elga.gv.at/CodeSystem/sciphox-seitenlokalisation"
  s:"2.16.840.1.113883.3.7.1.8" == t:"https://termgit.elga.gv.at/CodeSystem/sciphox-diagnosenzusatz"
  s:"2.16.840.1.113883.4.642.1.76" == t:"http://hl7.org/fhir/event-timing"
  s:"2.16.840.1.113883.4.642.3.115" == t:"https://termgit.elga.gv.at/CodeSystem/ips-conditionverificationstatus"
  s:"2.16.840.1.113883.4.642.3.155" == t:"https://termgit.elga.gv.at/CodeSystem/ips-conditionclinicalstatuscodes"
  s:"2.16.840.1.113883.5.1" == t:"http://terminology.hl7.org/CodeSystem/v3-AdministrativeGender"
  s:"2.16.840.1.113883.5.1008" == t:"http://terminology.hl7.org/CodeSystem/v3-NullFlavor"
  s:"2.16.840.1.113883.5.1052" == t:"http://terminology.hl7.org/CodeSystem/v3-ActSite"
  s:"2.16.840.1.113883.5.110" == t:"http://terminology.hl7.org/CodeSystem/v3-RoleClass"
  s:"2.16.840.1.113883.5.111" == t:"http://terminology.hl7.org/CodeSystem/v3-RoleCode"
  s:"2.16.840.1.113883.5.1119" == t:"http://terminology.hl7.org/CodeSystem/v3-AddressUse"
  s:"2.16.840.1.113883.5.1150.1" == t:"https://termgit.elga.gv.at/CodeSystem/ips-absentorunknowndata"
  s:"2.16.840.1.113883.5.129" == t:"http://terminology.hl7.org/CodeSystem/v3-SpecimenType"
  s:"2.16.840.1.113883.5.139" == t:"http://terminology.hl7.org/CodeSystem/v3-TimingEvent"
  s:"2.16.840.1.113883.5.14" == t:"http://terminology.hl7.org/CodeSystem/v3-ActStatus"
  s:"2.16.840.1.113883.5.143" == t:"http://terminology.hl7.org/CodeSystem/v3-URLScheme"
  s:"2.16.840.1.113883.5.2" == t:"http://terminology.hl7.org/CodeSystem/v3-MaritalStatus"
  s:"2.16.840.1.113883.5.25" == t:"http://terminology.hl7.org/CodeSystem/v3-Confidentiality"
  s:"2.16.840.1.113883.5.4" == t:"http://terminology.hl7.org/CodeSystem/v3-ActCode"
  s:"2.16.840.1.113883.5.43" == t:"http://terminology.hl7.org/CodeSystem/v3-EntityNamePartQualifier"
  s:"2.16.840.1.113883.5.45" == t:"http://terminology.hl7.org/CodeSystem/v3-EntityNameUse"
  s:"2.16.840.1.113883.5.60" == t:"http://terminology.hl7.org/CodeSystem/v3-LanguageAbilityMode"
  s:"2.16.840.1.113883.5.61" == t:"http://terminology.hl7.org/CodeSystem/v3-LanguageAbilityProficiency"
  s:"2.16.840.1.113883.5.88" == t:"http://terminology.hl7.org/CodeSystem/v3-ParticipationFunction"
  s:"2.16.840.1.113883.5.90" == t:"http://terminology.hl7.org/CodeSystem/v3-ParticipationType"
  s:"2.16.840.1.113883.6.121" == t:"https://termgit.elga.gv.at/CodeSystem/hl7-language-identification"
  s:"2.16.840.1.113883.6.24" == t:"https://termgit.elga.gv.at/CodeSystem/mdc-medicaldevicecommunications"
  s:"2.16.840.1.113883.6.254-2005" == t:"https://termgit.elga.gv.at/CodeSystem/icf"
  s:"2.16.840.1.113883.6.43.1" == t:"https://termgit.elga.gv.at/CodeSystem/icd-o-3"
  s:"2.16.840.1.113883.6.121" == t:"urn:ietf:bcp:47"
  s:"1.2.40.0.34.5.227" == t:"https://termgit.elga.gv.at/CodeSystem/hl7-at-maritalstatus-ergaenzung"
}

uses "http://hl7.org/cda/stds/core/StructureDefinition/ED" alias ED as source
uses "http://hl7.org/cda/stds/core/StructureDefinition/II" alias II as source
uses "http://hl7.org/fhir/4.3/StructureDefinition/Identifier" alias Identifier as target
uses "http://hl7.org/cda/stds/core/StructureDefinition/TS" alias TS as source
uses "http://hl7.org/fhir/4.3/StructureDefinition/instant" alias instant as target
uses "http://hl7.org/cda/stds/core/StructureDefinition/CS" alias CS as source
uses "http://hl7.org/fhir/4.3/StructureDefinition/code" alias code as target
uses "http://hl7.org/cda/stds/core/StructureDefinition/CE" alias CE as source
uses "http://hl7.org/cda/stds/core/StructureDefinition/CD" alias CD as source
uses "http://hl7.org/fhir/4.3/StructureDefinition/CodeableConcept" alias CodeableConcept as target
uses "http://hl7.org/fhir/4.3/StructureDefinition/Coding" alias Coding as target
uses "http://hl7.org/cda/stds/core/StructureDefinition/ST" alias ST as source
uses "http://hl7.org/fhir/4.3/StructureDefinition/string" alias string as target
uses "http://hl7.org/cda/stds/core/StructureDefinition/EN" alias EN as source
uses "http://hl7.org/cda/stds/core/StructureDefinition/PN" alias PN as source
uses "http://hl7.org/cda/stds/core/StructureDefinition/PQ" alias PQ as source
uses "http://hl7.org/cda/stds/core/StructureDefinition/IVXB-PQ" alias IVXB_PQ as source
uses "http://hl7.org/cda/stds/core/StructureDefinition/ON" alias ON as source
uses "http://hl7.org/fhir/4.3/StructureDefinition/HumanName" alias HumanName as target
uses "http://hl7.org/cda/stds/core/StructureDefinition/Organization" alias CdaOrganization as source
uses "http://hl7.org/fhir/4.3/StructureDefinition/Organization" alias Organization as target
uses "http://hl7.org/cda/stds/core/StructureDefinition/AD" alias AD as source
uses "http://hl7.org/fhir/4.3/StructureDefinition/Address" alias Address as target
uses "http://hl7.org/cda/stds/core/StructureDefinition/TEL" alias TEL as source
uses "http://hl7.org/fhir/4.3/StructureDefinition/ContactPoint" alias ContactPoint as target
uses "http://hl7.org/cda/stds/core/StructureDefinition/BL" alias BL as source
uses "http://hl7.org/fhir/4.3/StructureDefinition/boolean" alias boolean as target
uses "http://hl7.org/cda/stds/core/StructureDefinition/IVL-TS" alias IVL_TS as source
uses "http://hl7.org/cda/stds/core/StructureDefinition/IVXB-TS" alias IVXB_TS as source
uses "http://hl7.org/cda/stds/core/StructureDefinition/ANY" alias ANY as source

uses "http://hl7.org/fhir/4.3/StructureDefinition/Quantity" alias Quantity as target
uses "http://hl7.org/fhir/4.3/StructureDefinition/SimpleQuantity" alias SimpleQuantity as target
uses "http://hl7.org/fhir/4.3/StructureDefinition/Period" alias Period as target
uses "http://hl7.org/fhir/4.3/StructureDefinition/date" alias date as target
uses "http://hl7.org/fhir/4.3/StructureDefinition/Extension" alias Extension as target

group Any(source src, target tgt) {
}

group II(source src : II, target tgt : Identifier) extends Any <<types>> {
  // TODO deal with OIDs which are not part of the map (e.g. certain identifiers, GDA-IDs, etc.)
  // src.root as r where src.extension.exists()
  //    -> tgt.system = translate(r, 'http://hl7.org/fhir/ConceptMap/special-oid2uri', 'uri') "root1";
  src.root as r where src.extension.exists()
     -> tgt.system = translate(r, '#OIDtoURI', 'code') "root1";

  // testing if it is possible to use translate in where
  // src.root as r where (translate('#OIDtoURI', r)) ->
  //   tgt.system = translate(r, 'http://hl7.org/fhir/ConceptMap/special-oid2uri', 'uri') "root1";

  src.root as r where src.extension.empty()
        and src.root.matches('[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}')
     -> tgt.system = 'urn:ietf:rfc:3986', tgt.value = ('urn:uuid:' + r.lower()) "rootuuid";
  src.root as r where src.extension.empty() and src.root.contains('.')
     ->  tgt.system = 'urn:ietf:rfc:3986',  tgt.value = append('urn:oid:', r) "rootoid";
  src.extension as e -> tgt.value = e;
  src.assigningAuthorityName as s ->  tgt.assigner as a,  a.display = s;
  // there's no equivalent for displayable in FHIR - and it probably will never matter, but if it does, it might map to Identifier.use.
  src.displayable as displayable -> tgt.extension as ext then {
    displayable -> ext.url = 'http://hl7.org/cda/stds/core/StructureDefinition/extension-displayable' "url";
    displayable.value as v -> ext.value = cast(v, 'string');
  } "extension";
}

group INT(source src : INT, target tgt : integer) extends Any <<types>> {
  src.value as v -> tgt.value = v "integer";
}

group BL(source src : BL, target tgt: boolean) extends Any <<types>> {
  src.value as v -> tgt.value = v "boolean";
}

group TemplateID(source template : II, target tgt) {
  template -> tgt.extension as ext then {
    template -> ext.url = 'http://hl7.org/cda/stds/core/StructureDefinition/templateID' "url";
    template -> ext.value = create('Identifier') as value then II(template, value) "value";
  } "templateId";
}

group Negation(source negation : BL, target tgt) {
  negation -> tgt.modifierExtension as ext then {
    negation -> ext.url = 'http://hl7.org/cda/stds/core/StructureDefinition/negationIndicator' "url";
    negation as neg ->  ext.value = create('boolean'),  ext.value = neg "value";
  } "negation";
}

group TSInstant(source src : TS, target tgt : instant) extends Any <<types>> {
  src.value as v -> tgt.value = cast(v, 'string');
}

group IVL_TSDateTime(source src : IVL_TS, target tgt : instant) extends TSInstant <<types>> {
}

group TSDateTime(source src : TS, target tgt : dateTime) extends Any <<types>> {
  src.value as v -> tgt.value = cast(v, 'string');
}

group IVXB_TSDateTime(source src : IVXB_TS, target tgt : dateTime) extends TSDateTime <<types>> {
}

group TSDate(source src : TS, target tgt : date) extends Any <<types>> {
  // guaranteeing that only date will be transformed
  // src.value as v -> tgt.value = truncate(v,8) "TSdate";
  src.value as v -> tgt.value = cast(v, 'string');
}

group IVLTSPeriod(source src : IVL_TS, target tgt : Period) extends Any <<types>> {
  src.low -> tgt.start;
  src.high -> tgt.end;
}

group IVLTSDateTime(source src : IVL_TS, target tgt : dateTime) extends Any <<types>> {
  src.low as s then TSDateTime(s, tgt);
}

group STstring(source src : ST, target tgt : string) extends Any <<types>> {
  src as v -> tgt.value = (v.xmlText) "STstring";
}

group EDstring(source src : ED, target tgt : string) extends STstring <<types>> {
}

group ENstring(source src : EN, target tgt : string) extends Any <<types>> {
  src as v -> tgt.value = (v.item.xmlText) "value";
}

group ONstring(source src : ON, target tgt : string) extends ENstring <<types>> {
}

group CSCode(source src : CS, target tgt : code) extends Any <<types>> {
  src.code as c -> tgt.value = cast(c, 'string');
}

group CECode(source src : CE, target tgt : code) extends CSCode <<types>> {
}

group CDCode(source src : CD, target tgt : code) extends CSCode <<types>> {
}

group CECoding(source src : CE, target tgt : Coding) extends Any <<types>> {
  src.code as code -> tgt.code = cast(code, 'string');

  // https://github.com/hapifhir/org.hl7.fhir.core/blob/master/org.hl7.fhir.dstu2016may/src/main/java/org/hl7/fhir/dstu2016may/utils/StructureMapUtilities.java#L1027
  // https://github.com/hapifhir/org.hl7.fhir.core/blob/b590cb3fedbb0791702c637e76fefdae2cba2f78/org.hl7.fhir.r5/src/main/java/org/hl7/fhir/r5/context/ContextUtilities.java#L65
  // https://github.com/hapifhir/org.hl7.fhir.core/blob/b590cb3fedbb0791702c637e76fefdae2cba2f78/org.hl7.fhir.utilities/src/main/java/org/hl7/fhir/utilities/OIDUtils.java#L43
  // src.codeSystem as system -> tgt.system = translate(system, 'http://hl7.org/fhir/ConceptMap/special-oid2uri', 'uri');
  src.codeSystem as system -> tgt.system = translate(system, '#OIDtoURI', 'code');

  // TODO for testing purposes (validation with java validator), no displayNames will be mapped
    //      later the NCPeH will have to translate them
    // AIT HVi: Mapping will not only be used for NCPeH.. 
  src.displayName as display -> tgt.display = cast(display, 'string');
}

group CDCoding(source src : CD, target tgt : Coding) extends CECoding <<types>> {

}
group CECodeableConcept(source src : CE, target tgt : CodeableConcept) extends Any <<types>> {
  src.originalText -> tgt.text;
  src where ($this.nullFlavor.exists().not()) ->
    tgt.coding as coding
    // in order to be able to capture the primary code in case there are translations
    // 2025-07-28 CDA2FHIR AG decided to not use "userSelected" - in FHIR all codes are equal
    // coding.userSelected = true
    // HVi: This generates the empty text value in the coding, even though an original text is displayed
    then CECoding(src, coding) "code";
  src where ($this.nullFlavor.exists()) -> tgt.extension as tgt_extension then CdaNullFlavorToFhirNullFlavor(src, tgt_extension) "nullFlavor";
  src.translation as translation -> tgt.coding as coding then CDCoding(translation, coding);
}

group CSCodeableConcept(source src : CS, target tgt : CodeableConcept) extends CECodeableConcept <<types>> {
}

group CDCodeableConcept(source src : CD, target tgt : CodeableConcept) extends CECodeableConcept <<types>> {
}

// group ENHumanName(source src : EN, target tgt : HumanName) extends Any <<types>> {
//   src.family as v -> tgt.family = (v.dataString);
//   src.given as v -> tgt.given = (v.dataString);
//   src.prefix as v -> tgt.prefix = (v.dataString);
//   src.suffix as v -> tgt.suffix = (v.dataString);
//   //src.use as c -> tgt.use = translate(c, 'http://hl7.org/fhir/ConceptMap/cm-name-use-v3', 'code');
//   src.validTime -> tgt.period;
// }

// Source: https://art-decor.org/ad/#/at-lab-/rules/templates/1.2.40.0.34.6.0.11.9.12/2021-02-19T13:36:43
//         https://art-decor.org/ad/#/at-lab-/rules/templates/1.2.40.0.34.6.0.11.9.6/2021-02-19T13:36:49
//            TODO deal with nullFlavor
//         https://art-decor.org/art-decor/decor-templates--at-lab-?section=templates&id=1.2.40.0.34.6.0.11.9.11&effectiveDate=dynamic
// Target: http://hl7.org/fhir/R4/datatypes.html#HumanName
group CdaPersonNameCompilationToFhirHumanName(source cda_name : PN, target fhir_humanName : HumanName) extends Any <<types>> {
  cda_name.item as cda_name_item then {
    // name.use
    cda_name_item.use as cda_name_item_use -> fhir_humanName.use = translate(cda_name_item_use, '#ELGAEntityNameUseFHIRNameUse', 'code');

    // content of name-tag
    cda_name_item.xmlText as cda_name_item_xmlText -> fhir_humanName.text = (cda_name_item_xmlText);

    // name.prefix
    cda_name_item.prefix as cda_name_item_prefix ->
      // name.prefix
      fhir_humanName.prefix = (cda_name_item_prefix.xmlText) as fhir_humanName_prefix then {
        // name.prefix.qualifier
        cda_name_item_prefix where cda_name_item_prefix.qualifier.exists() then {
          cda_name_item_prefix.qualifier as qualifier ->
            fhir_humanName_prefix.extension as extension,
            extension.url = 'http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier',
            extension.value = translate(qualifier, '#ELGAEntityNamePartQualifierFHIRNamePartQualifier', 'code')
            "qualifierValue";
        } "CdaNamePrefixQualifierToFhirNameExtension";
      } "CdaNamePrefixToFhirNameGiven";

    // name.given
    cda_name_item.given as cda_name_item_given ->
      // name.given
      fhir_humanName.given = (cda_name_item_given.xmlText) as fhir_humanName_given then {
        // name.given.qualifier
        cda_name_item_given where cda_name_item_given.qualifier.exists() then {
          cda_name_item_given.qualifier as qualifier ->
            fhir_humanName_given.extension as extension,
            extension.url = 'http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier',
            extension.value = translate(qualifier, '#ELGAEntityNamePartQualifierFHIRNamePartQualifier', 'code')
            "qualifierValue";
        } "CdaNameGivenQualifierToFhirNameExtension";
      } "CdaNameGivenToFhirNameGiven";

    // name.family
    cda_name_item.family as cda_name_item_family ->
      // name.family
      fhir_humanName.family = (cda_name_item_family.xmlText) as fhir_humanName_family then {
        // name.family.qualifier
        cda_name_item_family where cda_name_item_family.qualifier.exists() then {
          cda_name_item_family.qualifier as qualifier ->
            fhir_humanName_family.extension as extension,
            extension.url = 'http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier',
            extension.value = translate(qualifier, '#ELGAEntityNamePartQualifierFHIRNamePartQualifier', 'code')
            "qualifierValue";
        } "CdaNameFamilyQualifierToFhirNameExtension";
      } "CdaNameFamilyToFhirNameGiven";

    // name.suffix
    cda_name_item.suffix as cda_name_item_suffix ->
      // name.suffix
      fhir_humanName.suffix = (cda_name_item_suffix.xmlText) as fhir_humanName_suffix then {
        // name.suffix.qualifier
        cda_name_item_suffix where cda_name_item_suffix.qualifier.exists() then {
          cda_name_item_suffix.qualifier as qualifier ->
            fhir_humanName_suffix.extension as extension,
            extension.url = 'http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier',
            extension.value = translate(qualifier, '#ELGAEntityNamePartQualifierFHIRNamePartQualifier', 'code')
            "qualifierValue";
        } "CdaNameSuffixQualifierToFhirNameExtension";
      } "CdaNameSuffixToFhirNameGiven";
  } "CdaNameItem";
}

// Source: https://art-decor.org/art-decor/decor-templates--at-lab-?section=templates&id=1.2.40.0.34.6.0.11.9.5&effectiveDate=2021-06-28T13:57:53&language=de-DE
// Target: http://hl7.org/fhir/organization.html
group CdaOrganizationCompilationToFhirOrganization(source cda_organization: CdaOrganization, target fhir_organization : Organization) {
  cda_organization.id -> fhir_organization.identifier;
  cda_organization.name -> fhir_organization.name;
  cda_organization.telecom -> fhir_organization.telecom;
  // cda_organization.addr as cda_organization_addr ->
  //   fhir_organization.address = create('Address') as fhir_organization_address then
  //   CdaAdressCompilationToFhirAustrianAddress(cda_organization_addr, fhir_organization_address)
  //   "CdaOrganizationAddressToFhirOrganizationAustrianAddress";
  cda_organization.addr -> fhir_organization.address;
}

// Source: https://art-decor.org/ad/#/at-lab-/rules/templates/1.2.40.0.34.6.0.11.9.25/2021-02-19T13:05:47
//         https://art-decor.org/ad/#/at-lab-/rules/templates/1.2.40.0.34.6.0.11.9.10/2021-06-28T13:44:14
// Target: https://fhir.hl7.at/r4-core-main/StructureDefinition-at-core-address.html
// based on BlackTusk
group CdaAdressCompilationToFhirAustrianAddress(source cda_address : AD, target fhir_address : Address) extends Any <<types>> {
  // Note: Profile not allowed here
  // src ->
  //   tgt.meta as meta,
  //   meta.profile = 'http://hl7.at/fhir/HL7ATCoreProfiles/4.0.1/StructureDefinition/at-core-address'
  //   "FhirAddressAtCoreAddressProfile";

  // addr.use
  cda_address.use as cda_use ->
    fhir_address.use = translate(cda_use, '#ELGA2FHIRAddressUse', 'code') then {
      cda_use where (cda_use != 'PHYS' and cda_use != 'PST') -> fhir_address.type = 'both' "CdaAddressUseToFhirAddressTypeBoth";
      cda_use where (cda_use = 'PHYS') -> fhir_address.type = 'physical' "CdaAddressUseToFhirAddressTypePhysical";
      cda_use where (cda_use = 'PST') -> fhir_address.type = 'postal' "CdaAddressUseToFhirAddressTypePostal";
    } "CdaAddressUseToFhirAddressUseAndType";

  cda_address.item as cda_address_item then {
    // addr.postalCode
    cda_address_item.postalCode as cda_postalCode -> fhir_address.postalCode = (cda_postalCode.xmlText);
    // addr.city
    cda_address_item.city as cda_city -> fhir_address.city = (cda_city.xmlText);
    // addr.state
    cda_address_item.state as cda_state -> fhir_address.state = (cda_state.xmlText);
    // addr.country
    cda_address_item.country as cda_country -> fhir_address.country = (cda_country.xmlText);
  } "CdaAddressItemSimple";

  // addr.streetName and addr.houseNumber and addr.additionalLocator
  cda_address where (cda_address.item.streetName.exists() and cda_address.item.houseNumber.exists() and cda_address.item.additionalLocator.exists()) ->
    fhir_address.line = (cda_address.item.streetName.xmlText + ' ' + cda_address.item.houseNumber.xmlText + ' ' + cda_address.item.additionalLocator.xmlText) as fhir_address_line then {
      cda_address.item as cda_address_item then {
        // extension for streetName
        cda_address_item.streetName as cda_address_item_streetName -> fhir_address_line.extension as extension,
          extension.url = 'http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-streetName',
          extension.value = (cda_address_item_streetName.xmlText)
          "CdaAdressToFhirStreetNameExtension";

        // extension for houseNumber
        cda_address_item.houseNumber as cda_address_item_houseNumber -> fhir_address_line.extension as extension,
          extension.url = 'http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-houseNumber',
          extension.value = (cda_address_item_houseNumber.xmlText)
          "CdaAdressToFhirHouseNumberExtension";

        // extension for additionalLocator
        cda_address_item.additionalLocator as cda_address_item_additionalLocator where (cda_address_item.additionalLocator.exists()) -> fhir_address_line.extension as extension,
          extension.url = 'http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-additionalLocator',
          extension.value = (cda_address_item_additionalLocator.xmlText)
          "CdaAdressToFhirAdditionalLocatorExtension";
      } "CdaAddressItemWithAdditionalLocator";
    } "CdaAddressStreetNameAndHouseNumberWithAdditionalLocatorToFhirAddressLine";

  // addr.streetName and addr.houseNumber and NOT addr.additionalLocator
  cda_address where (cda_address.item.streetName.exists() and cda_address.item.houseNumber.exists() and cda_address.item.additionalLocator.exists().not()) ->
    fhir_address.line = (cda_address.item.streetName.xmlText + ' ' + cda_address.item.houseNumber.xmlText) as fhir_address_line then {
      cda_address.item as cda_address_item then {
        // extension for streetName
        cda_address_item.streetName as cda_address_item_streetName -> fhir_address_line.extension as extension,
          extension.url = 'http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-streetName',
          extension.value = (cda_address_item_streetName.xmlText)
          "CdaAdressToFhirStreetNameExtension";

        // extension for houseNumber
        cda_address_item.houseNumber as cda_address_item_houseNumber -> fhir_address_line.extension as extension,
          extension.url = 'http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-houseNumber',
          extension.value = (cda_address_item_houseNumber.xmlText)
          "CdaAdressToFhirHouseNumberExtension";
      } "CdaAddressItemWithoutAdditionalLocator";
    } "CdaAddressStreetNameAndHouseNumberWithoutAdditionalLocatorToFhirAddressLine";

    // addr.streetAddressLine and additionalLocator
    cda_address where (cda_address.item.streetAddressLine.exists() and cda_address.item.additionalLocator.exists()) ->
      fhir_address.line = (cda_address.item.streetAddressLine.xmlText + ' ' + cda_address.item.additionalLocator.xmlText) as fhir_address_line
      then {
        cda_address.item as cda_address_item then {
          // extension for additionalLocator
          cda_address_item.additionalLocator as cda_address_item_additionalLocator where (cda_address_item.additionalLocator.exists()) -> fhir_address_line.extension as extension,
            extension.url = 'http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-additionalLocator',
            extension.value = (cda_address_item_additionalLocator.xmlText)
            "CdaAdressToFhirAdditionalLocatorExtension";
        } "CdaAddressItemWithAdditionalLocator";
      } "CdaAddressStreetNameAndHouseNumberWithAdditionalLocatorToFhirAddressLine";

    // addr.streetAddressLine and NOT additionalLocator
    cda_address where (cda_address.item.streetAddressLine.exists() and cda_address.item.additionalLocator.exists().not()) ->
      fhir_address.line = (cda_address.item.streetAddressLine.xmlText)
      "CdaAddressStreetNameAndHouseNumberWithoutAdditionalLocatorToFhirAddressLine";
}

// source: https://art-decor.org/mediawiki/index.php?title=DTr1_TEL.AT
// source: ELGA URL_Scheme, ELGA_TelecomAddressUse
// target: https://www.hl7.org/fhir/datatypes.html#2.24.0.15
// target: http://hl7.org/fhir/valueset-contact-point-system
// Based on BlackTusk
group TELContactPoint(source src : TEL, target tgt : ContactPoint) extends Any <<types>> {
  // telecom.use
  // https://termgit.elga.gv.at/ValueSet-elga-telecomaddressuse.html -> http://hl7.org/fhir/R4/valueset-contact-point-use.html
  src.use as u where (src.use.startsWith('H') or (src.use = 'EC')) -> tgt.use = translate(u,'#ELGATelecomAddressUseFHIRContactPointUse','code') "usehome";
  src.use as u where ((src.use = 'WP') or (src.use = 'AS')) -> tgt.use = translate(u,'#ELGATelecomAddressUseFHIRContactPointUse','code') "usework";
  src.use as u where ((src.use = 'MC') or (src.use = 'PG')) -> tgt.use = translate(u,'#ELGATelecomAddressUseFHIRContactPointUse','code') "usemobile";
  src.use as u where ((src.use = 'TMP')) -> tgt.use = translate(u,'#ELGATelecomAddressUseFHIRContactPointUse','code') "usetemp";

  // telecom.value
  // https://termgit.elga.gv.at/ValueSet-elga-urlscheme.html -> http://hl7.org/fhir/R4/valueset-contact-point-system.html
  src.value as v where (src.value.startsWith('fax:')) ->  tgt.value = (v.substring(4)),  tgt.system = 'fax' "valuefax";
  src.value as v where (src.value.startsWith('file:')) -> tgt.value = (v.substring(5)), tgt.system = 'other' "valuefile";
  src.value as v where (src.value.startsWith('ftp:')) -> tgt.value = (v.substring(4)), tgt.system = 'url' "valueftp";
  src.value as v where (src.value.startsWith('http:')) ->  tgt.value = (v.substring(7)),  tgt.system = 'url' "valuehttp";
  src.value as v where (src.value.startsWith('mailto:')) ->  tgt.value = (v.substring(7)),  tgt.system = 'email' "valuemail";
  src.value as v where (src.value.startsWith('mllp:')) -> tgt.value = (v.substring(5)), tgt.system = 'url' "valuemllp";
  src.value as v where (src.value.startsWith('modem:')) -> tgt.value = (v.substring(6)), tgt.system = 'other' "valuemodem";
  src.value as v where (src.value.startsWith('nfs:')) -> tgt.value = (v.substring(4)), tgt.system = 'other' "valuenfs";
  src.value as v where (src.value.startsWith('tel:')) ->  tgt.value = (v.substring(4)),  tgt.system = 'phone' "valuetel";
  src.value as v where (src.value.startsWith('telnet:')) -> tgt.value = (v.substring(7)), tgt.system = 'url' "valuetelnet";

  // 'me:' not part of ValueSet https://termgit.elga.gv.at/ValueSet-elga-urlscheme.html
  // src.value as v where (src.value.startsWith('me:')) -> tgt.value = (v.substring(3)), tgt.system = 'other' "valueme";

  // telecom.useablePeriod
  src.useablePeriod -> tgt.period;
}

group PQQuantity(source src : PQ, target tgt : Quantity) extends Any <<types>> {
  src -> tgt.system = 'http://unitsofmeasure.org' "FhirQuantitySystem";
  src.unit as unit ->
    tgt.code = unit,
    tgt.unit = unit;
  src.value as value -> tgt.value = value;
}

group IVLPQRange(source src : IVL_PQ, target tgt : Range) extends Any <<types>> {
  src.low as source_low -> tgt.low as target_low then PQQuantity(source_low, target_low) "IVLPQLow";
  src.high as source_high -> tgt.high as target_high then PQQuantity(source_high, target_high) "IVLPQHigh";
  // Range does not support any other elements, no official extensions defined
}

group IVXB_PQQuantity(source src : IVXB_PQ, target tgt : Quantity) extends PQQuantity <<types>> {
}

// group LowQuantity(source src : IVXB_PQ, target tgt : Quantity) extends PQQuantity <<types>> {
//   // inclusive missing
//   // TODO to be discussed
//   src where $this.inclusive.exists().not() -> tgt.comparator = '>' "CdaInclusiveToFhirComparatorMissing";
//   // inclusive = false
//   src where $this.inclusive=false -> tgt.comparator = '>' "CdaInclusiveToFhirComparatorNotInclusive";
//   // inclusive = true
//   src where $this.inclusive=true -> tgt.comparator = '>=' "CdaInclusiveToFhirComparatorInclusive";
// }

group RTOPQPQRatio(source src : RTO_PQ_PQ, target tgt : Ratio) extends Any <<types>> {
  src.numerator as numerator -> tgt.numerator as targetNumerator then PQQuantity(numerator, targetNumerator) "numerator";
  src.denominator as denominator -> tgt.denominator as targetDenominator then PQQuantity(denominator, targetDenominator) "denominator";
}

group CdaNullFlavorToFhirNullFlavor(source src : ANY, target tgt : Extension) extends Any <<types>> {
  src.nullFlavor as cda_nullFlavor then {
    cda_nullFlavor -> tgt.url = 'http://hl7.org/fhir/StructureDefinition/iso21090-nullFlavor' "url";

    cda_nullFlavor -> tgt.value = create('code') as fhir_extension_code,
      fhir_extension_code.value = (cda_nullFlavor)
      "code";
  } "CdaNullFlavorToFhirNullFlavor";
}